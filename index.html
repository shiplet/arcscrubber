<!DOCTYPE html>
<html>
<head>
    <title>Arc Scrubber</title>
    <style type="text/css">
        #circle {
            height: 25vw;
            width: 25vw;
            border: 1px solid black;
            border-radius: 50%;
            margin: 0 auto;
            margin-top: calc((100vh - 25vw)/2);
            box-sizing: border-box;
            position: relative;
            z-index: 0;
        }

        #box {
            width: 12.5vw;
            height: 4.6875vw;
            box-sizing: border-box;
            border: 1px solid black;
            position: absolute;
            top: calc((100vh - 25vw)/2);
            right: 0;
            left: 0;
            margin: 0 auto;
            z-index: 1;
        }

        #dot {
            height: 1.5625vw;
            width: 1.5625vw;
            background-color: black;
            border-radius: 50%;
            position: absolute;
            bottom: 0;
            left: 0;
        }
    </style>
</head>
<body>



    <div id="circle">
    </div>
    <div id="box">
        <div id="dot"></div>
    </div>



    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function(){


            var circle = document.getElementById('circle')
            var dot = document.getElementById('dot')
            var box = document.getElementById('box')
            var dragging = false


            // Create reference points for circle
            var left, top, diameter, radius, center
            var mosPosX, dotPosY, dotPosX

            calcView()
            dotPos(0)

            window.addEventListener('resize', calcView, false)
            box.addEventListener('mousemove', calcDotPos, false)
            dot.addEventListener('mousedown', activateDot, false)
            box.addEventListener('mouseup', deactivateDot, false)


            /*
                Core formula:

                    dotPosY = (boxHeight - (circleRadius - Math.sqrt(circleRadius**2 - mosPosX**2))) - dotHalfWidth

                    >> dotPosY must be negative if using translate3d()
                    >> dotHalfWidth is to center the dot on the circle bounds)


                TODO:
                   >> dotPosX overflows x-bounds of containing box when dot-mouseover
            */

            function activateDot() {
                dragging = true
            }

            function deactivateDot() {
                dragging = false
            }

            function dotPos(mosPos) {
                event.clientX = mosPos === 0 ? window.innerWidth / 2 : event.clientX
                mosPosX = center - event.clientX
                dotPosY = -((box.offsetHeight - (radius - Math.sqrt(radius**2 - mosPosX**2))) - (dot.offsetWidth/2))
                dotPosX = (Math.min(event.clientX - left, diameter) - ((box.offsetWidth/2) + (dot.offsetWidth/2)))
                dot.style.transform = 'translate3d('+dotPosX+'px, '+dotPosY+'px, 0)'
            }

            function calcDotPos(){
                if(dragging) { dotPos() }
            }

            function calcView(event) {
               left = circle.offsetLeft + circle.clientLeft
               top = circle.offsetTop + circle.clientTop
               diameter = circle.offsetWidth
               radius = diameter / 2
               center = (left + (left + diameter)) / 2
            }

        }, false)
    </script>

</body>
</html>