<!DOCTYPE html>
<html>
<head>
    <title>Arc Scrubber</title>
    <style type="text/css">
        #circle {
            height: 25vw;
            width: 25vw;
            border: 1px solid black;
            border-radius: 50%;
            margin: 0 auto;
            margin-top: calc((100vh - 25vw)/2);
            box-sizing: border-box;
            position: relative;
            z-index: 0;
        }

        #box {
            width: 12.5vw;
            height: 4.6875vw;
            box-sizing: border-box;
            border: 1px solid black;
            position: absolute;
            top: calc((100vh - 25vw)/2);
            right: 0;
            left: 0;
            margin: 0 auto;
            z-index: 1;
        }

        #dot {
            height: 1.5625vw;
            width: 1.5625vw;
            background-color: black;
            border-radius: 50%;
            position: absolute;
            bottom: 0;
            left: 0;
            cursor: -webkit-grab;
            cursor: -moz-grab;
            cursor: -ms-grab;
            cursor: -o-grab;
            cursor: grab;
        }

        #dot:active {
            cursor: -webkit-grabbing;
            cursor: -moz-grabbing;
            cursor: -ms-grabbing;
            cursor: -o-grabbing;
            cursor: grabbing;
        }
    </style>
</head>
<body>



    <div id="circle">
    </div>
    <div id="box">
        <div id="dot"></div>
    </div>



    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function(){


            var circle = document.getElementById('circle')
            var dot = document.getElementById('dot')
            var box = document.getElementById('box')
            var dragging = false


            // Create reference points for circle
            var left, top, diameter, radius, center
            var mosPosX, dotPosY, dotPosX
            var minY, minX, maxX

            calcView()
            dotPos(null, 0)

            window.addEventListener('resize', calcView)
            box.addEventListener('mousemove', shouldDotMove)
            dot.addEventListener('mousedown', activateDot)
            document.addEventListener('mouseup', deactivateDot)


            /*
                Core formula:

                    dotPosY = (boxHeight - (circleRadius - Math.sqrt(circleRadius^2 - mosPosX^2))) - dotHalfWidth

                    >> dotPosY must be negative if using translate3d()
                    >> dotHalfWidth is to center the dot on the circle bounds)
            */

            function activateDot() { dragging = true }
            function deactivateDot() { dragging = false }
            function shouldDotMove(event){ if(dragging) { dotPos(event) } }

            function dotPos(event, mosPos) {
                event = event || {}
                event.clientX = mosPos === 0 ? window.innerWidth / 2 : event.clientX
                mosPosX = event.clientX - center
                dotPosY = -( ( box.offsetHeight - ( radius - Math.sqrt( Math.pow( radius,2 ) - Math.pow( Math.min( Math.abs( mosPosX ), minY ), 2 ) ) ) ) - ( dot.offsetWidth/2 ) )
                dotPosX = (event.clientX - left) - ((box.offsetWidth/2) + (dot.offsetWidth/2))
                if(dotPosX <= minX) { dotPosX = minX }
                if(dotPosX >= maxX) { dotPosX = maxX }
                dot.style.transform = 'translate3d('+dotPosX+'px, '+dotPosY+'px, 0)'
            }


            function calcView(event) {
               left = circle.offsetLeft + circle.clientLeft
               top = circle.offsetTop + circle.clientTop
               diameter = circle.offsetWidth
               radius = diameter / 2
               center = (left + (left + diameter)) / 2
               minY = box.offsetWidth / 2
               minX = -(dot.offsetWidth/2)
               maxX = box.offsetWidth - (dot.offsetWidth/2)
               dotPos(null, 0)
            }

        }, false)
    </script>

</body>
</html>